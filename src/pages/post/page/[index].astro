---
import type { GetStaticPaths } from "astro";
import Base from "@layouts/Base.astro";
import { paginated } from "@lib/collection-helper";
import { PAGE_SIZE } from "@lib/constant";
import PostIndex from "@components/common-page/post-index.astro";

export const getStaticPaths = (async () => {
  const posts = await paginated("post", PAGE_SIZE);
  return [...posts.keys()]
    .map((index) => index)
    .filter((index) => index !== 0)
    .map((index) => ({ params: { index: index + 1 }, props: { index } }));
}) satisfies GetStaticPaths;

const pages = await paginated("post", PAGE_SIZE);
---

<Base
  title={`posts (${Astro.params.index})`}
  description={`posts page ${Astro.params.index + 1} of ${pages.length}`}
  imageUrl={`https://www.namachan10777.dev/post/page/${Astro.props.index + 1}.webp`}
  og={{ type: "website" }}
>
  <PostIndex index={Astro.props.index} />
</Base>
